# 課題1（質問）

## キャッシュの必要性

キャッシュは英語で「cache」と表記し、「貯蔵所」「隠し場所」という意味を

もち、一度読み込んだ内容・情報を一時的に保存することで次回、閲覧する際に素早く

読み込めるようになる。

## キャッシュの種類

### ブラウザキャッシュ

初回Webページを表示する際に、必要なファイルデータを全てダウンロードしてページの

表示をする。

その際にダウンロードしたデータ(画像、HTML,CSS,Javascriptなど)はキャッシュとして

ブラウザに保存される。

ブラウザに保存されているデータを同じものが必要になった場合は、サーバーにリクエストを送らずに

キャッシュデータを参照する。

メリットとしては、再度同じページを表示する際に、以前表示した時より速くページを表示できる。

デメリットは場合によって、更新したコンテンツが即時に反映されないのとキャッシュを溜めすぎると

ブラウザの動作が遅くなる。

### プロキシキャッシュ

社内LANなどローカルネットワークとインターネットの間に設置してあるプロキシサーバーにデータが保存されたものを指す。

キャッシュの情報はデバイスごとではなく、プロキシサーバーに接続している全てのデバイス分が

保存される。

### CDNキャッシュ

「キャッシュ時間」という考え方があり、オリジンサーバーの代わりにキャッシュサーバーが持っているデータを配信する仕様上、オリジンサーバー上のファイルを更新しても
そのファイルをキャッシュサーバーに渡せなければ、古いデータが配信されてしまう。それを防ぐ仕組みがキャッシュ時間。

キャッシュ時間を30分とした場合、30分を過ぎたらキャッシュサーバーは再度オリジンサーバーへ最新のファイルを取りに行く。
これによりCDNから常に最新のデータを配信することができるが、キャッシュ時間はサイトの更新頻度やアクセス数といった特性に
応じて適切に設定する必要がある。

https://baremetal.jp/blog/2021/08/17/1070/

### キャッシュを制御するヘッダー3つ

Cache-Control
リクエストとレスポンスの両方でキャッシュのためのディレクティブ（指示）が格納されている

Age
主にキャッシュサーバが返すヘッダフィールド。リソース・コンテンツが生成されてからの経過秒を提示する。

Expires
値 0 のような無効な日付は過去の日付を表し、リソースがすでに有効期限切れであることを意味する。

### ブラウザのキャッシュサイズ

### Chrome

キャッシュの最大サイズを利用可能なディスク容量の割合として計算し設定する。

例えば、ディスク容量が10GBならキャッシュの上限は1GB。

キャッシュがたまるとブラウザの処理が遅くなる。

### Firefox

キャッシュの最大サイズは1024MB。

キャッシュがたまるとブラウザの処理が遅くなる。

## expiresヘッダをレスポンス設定

### 動的なサイトで含めない方が良い理由

**Expires**

```
Expires: Mon, 29 Jan 2018 12:00:00 GMT
```

上記のように指定する。

基本的に過去のデータを参照するためユーザーに対しては古い情報を与えてしまう可能性があるため

特定商取引法のページや会社概要などの更新頻度が高くないページに設定する方が良い。

動的なサイトの場合はLast-ModifiedかETagを設定すると良い。
更新されていない場合には304 Not Modifiedが返却される。

引用:https://www.yunabe.jp/docs/browser_cache_control.html

## キャッシュのWEBサービス3つ

compassのページ

CSSファイルがmax-age=31536000となっている。

31536000秒は8760時間のため365日。1年間の有効期限を設定している。

![スクリーンショット 2021-09-20 0 16 36](https://user-images.githubusercontent.com/58420905/134767220-2305fef3-7eea-490c-94a8-0f106e3a2101.png)


youtubeのページ

cache-control:private, max-age=21284

自分のビデオのキャッシュを約6時間(21284/3600)持つ

<img width="1152" alt="スクリーンショット 2021-09-20 20 58 28" src="https://user-images.githubusercontent.com/58420905/134767231-a213923d-ed00-40da-9aed-215261390d57.png">


udemyのログインページ

cache-control: public, max-age=7200

google-analysticsの有効キャッシュが2時間(7200/3600)

<img width="1064" alt="スクリーンショット 2021-09-20 22 02 08" src="https://user-images.githubusercontent.com/58420905/134767239-7763e201-13b3-406b-9151-3e6c8e8ea64c.png">


## 課題２（実装）

### Githubを参照ください

## 課題3 (成果物に関する質問)

### サービス

ニュースサイト

### ページ

トップページ

### ファイル

htmlファイル

### キャッシュ

情報量が多いファイル（変更する項目が多いため）

## 課題４（クイズ）

1.初心者エンジニアhoge君が入社してきました。「先輩、クッキーとキャッシュの違いがわかりません。どっちを使うのが良いのか教えてください！」初心者でもわかりやすいように、それぞれの説明とメリット、デメリットを説明してください

2.HTTPレスポンスによるキャッシュ偽造攻撃対策はどのようなことをすれば良いか

3.max-age=3600の保存期間はどれくらいでしょうか。次の三つの中から選んでください。どのような方程式で算出したのか示してください。

- 1時間
- 1日
- 半日
